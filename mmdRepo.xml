<meta_metadata_repository name="default_repository"
	default_user_agent_name="chrome_2" package="ecologylab.semantics.conceptmapping.generated"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<user_agents>
		<user_agent name="ie_5"
			string="Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 5.0" />
		<user_agent name="firefox_2"
			string="Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1.7) Gecko/20070914 Firefox/2.0.0.7" />
		<user_agent name="firefox_3_5"
			string="Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US; rv:1.9.1.2) Gecko/20090729 Firefox/3.5.2 (.NET CLR 3.5.30729)" />
		<user_agent name="chrome_2"
			string="Mozilla/5.0 (Windows; U; Windows NT 6.0; en-US) AppleWebKit/530.5 (KHTML, like Gecko) Chrome/2.0.172.43 Safari/530.5" />
		<user_agent name="google_bot_0"
			string="Googlebot/2.1 (+http://www.google.com/bot.html)" />
		<user_agent name="google_bot_1" default="true"
			string="Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)" />
		<user_agent name="google_bot_2"
			string="Googlebot/2.1 (+http://www.googlebot.com/bot.html)" />
		<user_agent name="opera_9" string="Opera/9.25 (Windows NT 6.0; U; en)" />
	</user_agents>

	<!--
		+++++++++++++++++++++++++++++++++ Builtin Primitive Base Types
		+++++++++++++++++++++++++++++++++
	-->

	<!-- The Declaration of Document Class  -->
	<meta_metadata name="document" extends="metadata"
		generate_class="false" comment="The Document Class">
		<meta_metadata_field name="title" scalar_type="String"
			style="h1" comment="The Title of the Document" navigates_to="location" />
		<meta_metadata_field name="description"
			scalar_type="String" />
		<meta_metadata_field name="location" scalar_type="ParsedURL"
			always_show="true" comment="The document's actual location." />
		<meta_metadata_field name="generation"
			scalar_type="Int" />
		<meta_metadata_field name="page_structure"
			scalar_type="String"
			comment="For debugging. Type of the structure recognized by information extraction." />
		<meta_metadata_field name="query" scalar_type="String"
			comment="The search query" />
	</meta_metadata>

	<!--
		NOTE :: Use Lower case characters for all names. XML convention has no
		capital letters for tag names. We follow a similar convention. Any
		upper case chars in the name will cause issues !
	-->
	<!--
		this mmd has been adapted to use with locally hosted of wikipedia
		articles. -yin qu
	-->
	<meta_metadata name="wikipedia_page" extends="document"
		parser="xpath" url_path_tree="http://localhost/wiki/"
		package="ecologylab.semantics.conceptmapping.generated" comment="An article on local wikipedia">
		
		<meta_metadata_field name="title"
			xpath="//h1[@class='firstHeading']" />
			
		<meta_metadata_field name="outlinks" collection="ArrayList"
			xpath="//div[@id='bodyContent']/p/a[@title]" child_type="outlink">
			<meta_metadata_field name="surface" scalar_type="String"
				xpath="string(.)" />
			<meta_metadata_field name="target_concept" scalar_type="String"
				xpath="./@title" />
		</meta_metadata_field>
		
		<meta_metadata_field name="categories" collection="ArrayList"
			xpath="//div[@id='mw-normal-catlinks']/span/a" child_type="category">
			<meta_metadata_field name="category" scalar_type="String"
				xpath="./@title" />
		</meta_metadata_field>

		<semantic_actions>
			<!--
				get_field semantic action brings information from metadata structure
				to current context for use
			-->
			<get_field name="title" />
			<get_field name="location" />
			<create_concept>
			    <arg value="title" name="title" />
			    <arg value="location" name="location" />
			</create_concept>
			
			<get_field name="outlinks" />
			<for_each collection="outlinks" as="outlink">
				<get_field object="outlink" name="surface" />
				<get_field object="outlink" name="target_concept" />
				<add_concept_outlink>
					<arg value="surface" name="surface" />
					<arg value="target_concept" name="target_concept" />
				</add_concept_outlink>
			</for_each>
			
			<get_field name="categories" />
			<for_each collection="categories" as="category">
			    <get_field object="category" name="category" />
			    <add_concept_category>
			        <arg value="category" name="category" />
			    </add_concept_category>
			</for_each>
			
			<finish_concept />
		</semantic_actions>
	</meta_metadata>
</meta_metadata_repository>
